# **DNS**

## الترجمة الحرفية  
**Domain Name System (DNS)** — **نظام أسماء النطاقات**.

## الوصف العربي المختصر  
دفتر عناوين موزّع يترجم **أسماء النطاقات** مثل `example.com` إلى **عناوين IP** وبيانات أخرى.  
يعتمد على **سجلات** (A/AAAA/CNAME/MX/SRV/TXT…) و**تخزين مؤقّت (Caching)** و**زمن صلاحية (TTL)**.

## الشرح المبسّط  
- تبدأ من **المحلّل التكراري** (Recursive Resolver) لدى مزوّدك.  
- يصعد إلى **الجذور** ثم **TLD** (`.com`) ثم **الخوادم المخوّلة** لاسمك.  
- يعود بـ **سجلّ** + **TTL**. المحلّل والمتصفح يخزّنان النتيجة مؤقتًا.  
- أنواع مهمة:  
  - **A/AAAA**: عنوان IPv4/IPv6.  
  - **CNAME**: اسم مستعار لاسم آخر.  
  - **MX**: خوادم البريد.  
  - **NS**: خوادم نطاقك المخوّلة.  
  - **TXT**: نص عام (مثل SPF/تحققات).  
  - **SRV**: خدمة + منفذ.  
- دعم أمان اختياري: **DNSSEC** يوقّع السجلات لمنع التلاعب.

## تشبيه  
مثل **مركز اتصالات**: تعطيه اسم الشخص، فيبحث في الدليل ويعطيك **رقم الهاتف** الصحيح.  
يحفظ الأرقام الشائعة **مؤقتًا** لتسريع المكالمات التالية.

## مثال كود C# بسيط (استعلام عناوين + عكسية)
```csharp
using System;
using System.Net;
using System.Threading.Tasks;

class Program
{
    static async Task Main()
    {
        // 1) تحويل اسم إلى عناوين IP (A/AAAA حسب المتاح)
        string host = "example.com";
        IPAddress[] ips = await Dns.GetHostAddressesAsync(host);
        foreach (var ip in ips)
            Console.WriteLine($"{host} -> {ip}");

        // 2) استعلام عكسي: IP -> اسم (PTR)، إن توفر
        if (ips.Length > 0)
        {
            try
            {
                var entry = await Dns.GetHostEntryAsync(ips[0]);
                Console.WriteLine($"{ips[0]} -> {entry.HostName}");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Reverse lookup failed: {ex.Message}");
            }
        }
    }
}
```
**ملاحظات:** `Dns.*` يستخدم **المحلّل في نظام التشغيل**. لا يوفّر استعلام سجلات غير A/AAAA/PTR مباشرة.  
لاستخراج MX/TXT/SRV ستحتاج مكتبة DNS متخصّصة أو استعلام **DoH/DoT** عبر HTTP/TLS.

## خطوات عملية لإدارة DNS (Checklist)
- احجز نطاقك من **مسجّل**.  
- عيّن **خوادم الأسماء (NS)** إلى موفّر DNS الذي ستدير عنده السجلات.  
- أنشئ سجلات:  
  - **A/AAAA** لـ `@` و/أو `www`.  
  - **CNAME** للبيئات أو الخدمات المستضافة.  
  - **MX** للبريد + **TXT** (SPF, DKIM, DMARC).  
  - **SRV** إن كانت لديك خدمات تكتشف آليًا.  
- اختر **TTL** مناسب: صغير أثناء الإطلاق/التغييرات، أكبر للاستقرار.  
- فعّل **DNSSEC** إن كان المسجّل والموفّر يدعمانه.  
- افهم **Propagation**: تحديث NS قد يستغرق ساعات؛ تغييرات داخلية تتبع **TTL**.  
- للبريد الصادر: اضبط **PTR (Reverse DNS)** لدى مزوّد IP لتفادي تصنيف الرسائل كعشوائية.  

## أخطاء شائعة
- وضع **CNAME** على الجذر `@` لدى موفّرين لا يدعمون **ALIAS/ANAME**.  
- TTL مرتفع أثناء التبديل → تأخير انتشار التغيير.  
- ترك **MX** يشير إلى مضيف بلا **A/AAAA** صالح.  
- إعداد SPF خاطئ أو تكرار متضارب في سجلات TXT.  
- الاعتماد على DNS غير موثوق دون **DNSSEC** في بيئات حسّاسة.  

## جدول مقارنة مختصر

| المفهوم | الغرض الرئيسي | ملاحظات مهمة |
|---|---|---|
| mDNS| حلّ أسماء محلي بلا خادم مركزي | يعمل داخل الشبكات المحلية عبر Multicast فقط |
| **DNS** | **نظام تسمية موزّع لترجمة الأسماء لعناوين** | **سجلات متعددة + TTL/Caching + مخوَّل/تكراري + خيار DNSSEC** |
| DoH/DoT| تشفير استعلامات DNS فوق HTTPS/TLS | يحمي الخصوصية أثناء النقل؛ لا يغيّر دلالات السجلات |

## ملخص الفكرة  
**DNS** هو “دفتر عناوين الإنترنت”. يربط الاسم بالعناوين والخدمات مع تخزين مؤقت وTTL.  
أدر سجلاتك بعناية، استخدم TTL مناسبًا، وفكّر في **DNSSEC** و**DoH/DoT** عند الحاجة للثقة والخصوصية.
