# **PaaS — Platform as a Service**

## الترجمة الحرفية  
**Platform as a Service (PaaS)** — **منصّة كخدمة**

## الوصف العربي المختصر  
بيئة مُدارة للنشر تُعطيك **منصّة جاهزة** لتشغيل تطبيقاتك (Runtime/OS/شبكات/توسعة/مراقبة).  
أنت ترفع **الكود/الحاوية** وتضبط المتغيّرات؛ المزوّد يتكفّل بالبنية، التوسّع، التحديثات، والشهادات.

## الشرح المبسّط  
- بدل إدارة خوادم ونُظم، تركّز على **منطق التطبيق**.  
- مزايا شائعة: **نشر بضغطة**، **Scaling تلقائي**، **Logs/Metrics**، **SSL/TLS**، **بيئات Staging**.  
- أمثلة: Azure App Service، Google App Engine، AWS Elastic Beanstalk، Render، Fly.io، Heroku.

## تشبيه  
تستأجر **مطبخًا مجهّزًا بالكامل**: أفران، شفاط، نظافة، توصيل.  
أنت تجلب **الوصفة والمكوّنات** (الكود) وتطبخ؛ إدارة المطبخ على المزوّد.

---

## مثال كود C# (ASP.NET Core على PaaS: صحّة + منفذ من البيئة)
> العديد من مزوّدي PaaS يمرّرون رقم المنفذ عبر متغيّر بيئة `PORT`.  
> هذا المثال يلتقطه ويعرّف مسار صحّة للنشر/التوسّع الآلي.

```csharp
// Program.cs (.NET 8/9)
using Microsoft.AspNetCore.Diagnostics.HealthChecks;

var builder = WebApplication.CreateBuilder(args);

// التقط المنفذ من البيئة (Heroku/Render/Fly وغيرها)
if (int.TryParse(Environment.GetEnvironmentVariable("PORT"), out var port))
{
    builder.WebHost.ConfigureKestrel(o => o.ListenAnyIP(port));
}

// صحّة وخدمات أساسية
builder.Services.AddHealthChecks();
builder.Services.AddLogging();

var app = builder.Build();

app.MapGet("/", () =>
{
    var msg = Environment.GetEnvironmentVariable("APP_MESSAGE") ?? "Hello PaaS";
    return Results.Ok(new { message = msg, time = DateTime.UtcNow });
});

// مسارات صحّة شائعة
app.MapHealthChecks("/healthz");             // جاهزية/حيوية للبروكسي/الموازِن
app.MapGet("/ready", () => Results.Ok());    // جاهزية منفصلة إن رغبت

// تأمين افتراضي (يُنصح بتمكين HTTPS/HSTS على مستوى المنصّة)
app.Run();
```

**الإخراج المتوقع (مختصر):**  
- `GET /` يعيد JSON فيه رسالة من البيئة + وقت.  
- `GET /healthz` و`GET /ready` يعيدان 200 لاختبارات الصحّة.

---

## خطوات عملية للنشر على PaaS (مثال عام)
1. **حضّر التطبيق**: أضِف مسار صحّة (`/healthz`) واستخدم متغيّر `PORT`.  
2. **إدارة الإعدادات**: خزّن الأسرار في **Key Vault/Config** الخاص بالمزوّد؛ لا تضعها في الكود.  
3. **اختر طريقة النشر**:  
   - كود مباشر (Build على المنصّة) أو  
   - **حاوية** مع Dockerfile (Multi-stage) أو  
   - CI/CD من GitHub/DevOps.  
4. **اضبط الشبكة/النطاق**: اربط **DNS**، فعّل **TLS/HTTPS**، و—إن أمكن—**HSTS**.  
5. **التوسّع**: عيّن قواعد **Autoscale** (CPU/الطلبات/الزمن) وحدود الموارد.  
6. **المراقبة**: فعّل **Logs/Metrics/Tracing**، وأضِف تنبيهات للفشل/التأخير.  
7. **بيئات**: أنشئ **Staging/Production** مع فتحات نشر (Slots) لاختبار آمن قبل التبديل.

---

## أخطاء شائعة
- عدم الاستماع على **المنفذ الممرَّر** من المنصّة → التطبيق لا يستقبل.  
- الاعتماد على **ملفّات محليّة** دائمة (العديد من PaaS تخزينها عابر) بدل تخزين خارجي (Blob/DB).  
- وضع الأسرار في **الكود/المستودع** بدل **مدير أسرار**.  
- تجاهل **مسارات الصحّة** و**مهلات** → قرارات توسّع/إعادة تشغيل خاطئة.  
- إهمال **قيود الخرج/الجدار الناري** أو عدم تفعيل **HTTPS افتراضيًا**.  
- نقل تطبيق يعتمد على **Session In-Proc** دون استخدام **مخزن جلسات خارجي** (Redis/DB).

---

## جدول مقارنة مختصر

| المفهوم | الغرض الرئيسي | ملاحظات مهمة |
|---|---|---|
| [IaaS](iaas.md) | خوادم افتراضية تديرها أنت (OS/شبكة) | حرّية عالية؛ عبء إدارة أعلى (تصحيحات/توسّع) |
| **PaaS** | **تشغيل الكود على منصّة مُدارة** | **نشر سريع، Autoscale، شهادات، Logs؛ تحكّم أقل بالـ OS** |
| [SaaS](saas.md) | تطبيق جاهز للمستخدم النهائي | أقل تخصيص على المستوى البرمجي؛ لا تنشر كودك أنت |

---

## ملخص الفكرة  
**PaaS** يجعلك تركّز على **الكود والميزات** بينما تُدار البنية والتوسّع تلقائيًا.  
اضبط **PORT/health checks/الأسرار**، فعّل **HTTPS/مراقبة**، واستخدم **Autoscale** لتحصل على نشرٍ سريع وموثوق.
