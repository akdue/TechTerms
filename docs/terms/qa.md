# **QA — Quality Assurance**

## الترجمة الحرفية  
**Quality Assurance (QA)** — **ضمان الجودة**

## الوصف العربي المختصر  
مجموعة **ممارسات وقواعد** تمنع العيوب قبل حدوثها،  
وتضمن أن المنتج يلبّي **المتطلبات** و**سمات الجودة** (أداء، أمان، موثوقية).

## الشرح المبسّط  
- **وقائي**: يضع **معايير**، **مراجعات كود**، **استراتيجية اختبار**.  
- يعتمد **أتمتة** في CI/CD مع **بوابات جودة** (Quality Gates).  
- يقيس: **معدّل العيوب**، **تسرّب العيوب للإنتاج**، **تغطية الاختبارات**، **زمن الإصلاح**.  
- يشمل: توثيق **معايير القبول**، إدارة المتطلبات، وتحسين العملية باستمرار.

## تشبيه  
سير تصنيع بسيطرة جودة شاملة: مقاييس، قوائم فحص، أجهزة قياس.  
الهدف: **منع العيب** لا مجرد اكتشافه بعد خروجه.

---

## مثال عملي مختصر — C# + xUnit + “بوابة جودة” ذكية

> القاعدة: “السعر بعد الخصم لا يقلّ عن صفر”.  
> نكتب اختبارًا، ننفّذ المنطق، ونضيف **عقودًا دفاعية** (Guards).

```csharp
// PriceCalculator.cs
using System;

/// <summary>
/// Rule: الخصم بين 0..1. لا يعود الناتج أقل من 0. تقريبه لـ 2 منازل.
/// </summary>
public class PriceCalculator
{
    public decimal Final(decimal price, double discount)
    {
        if (price < 0) throw new ArgumentOutOfRangeException(nameof(price));
        var d = Math.Clamp(discount, 0d, 1d);
        var result = price - price * (decimal)d;
        return result <= 0 ? 0 : decimal.Round(result, 2);
    }
}
```

```csharp
// PriceCalculatorTests.cs  (xUnit)
// dotnet add package xunit
// dotnet add package xunit.runner.visualstudio
using Xunit;

public class PriceCalculatorTests
{
    [Theory]
    [InlineData(100, 0.10, 90)]
    [InlineData(50,  0.00, 50)]
    [InlineData(10,  0.50, 5)]
    [InlineData(10,  2.00, 0)] // يثبت شرط "لا يقل عن صفر"
    public void FinalPrice_Complies_With_Rules(decimal price, double discount, decimal expected)
    {
        var calc = new PriceCalculator();
        Assert.Equal(expected, calc.Final(price, discount));
    }

    [Fact]
    public void NegativePrice_Throws()
    {
        var calc = new PriceCalculator();
        Assert.Throws<ArgumentOutOfRangeException>(() => calc.Final(-1, 0.1));
    }
}
```

> **تلميح CI (Quality Gate):** اجعل التحذيرات أخطاءًا، وافرض حدًا لتغطية الاختبارات.  
> ملف ‎`Directory.Build.props` (MSBuild) يمكنه تفعيل `TreatWarningsAsErrors`،  
> ويمكن تشغيل التغطية عبر أدوات مثل **coverlet** في خطّ CI (`dotnet test /p:CollectCoverage=true /p:Threshold=80`).

---

## خطوات عملية لتطبيق QA فعّال
1. **عرّف الجودة**: متطلبات وظيفية ولا-وظيفية (أداء، أمان، توفّر) + **معايير قبول**.  
2. **استراتيجية اختبار**: هرم الاختبارات (وحدات ≫ تكامل ≫ طرف-لطرف)، اختبارات أداء/أمن.  
3. **حوكمة الكود**: معايير تنسيق، **تحليل ثابت** (Analyzers)، مراجعات PR.  
4. **أتمتة**: بناء، فحص، اختبارات، تغطية، تحليل تبعيات وثغرات، **بوابات** تمنع الدمج عند الفشل.  
5. **إدارة العيوب**: تصنيف، أولوية، تتبّع زمن الحل، تحليل السبب الجذري (RCA).  
6. **مقاييس**: معدل العيوب/أسبوع، **Escape Rate** (عيوب الإنتاج)، **وقت الإصلاح**، التغطية (كمؤشر لا هدف).  
7. **تحسين مستمر**: دروس مستفادة بعد كل إصدار، تحديث السياسات، تدريب الفريق.

---

## أخطاء شائعة
- اعتبار **QA = اختبار يدوي فقط**. QA أوسع: **عملية + معايير + أتمتة**.  
- السعي وراء **٪100 تغطية** بلا قيمة. التغطية مؤشر، وليست هدفًا بحد ذاته.  
- غياب **معايير قبول** واضحة → نزاعات وتأخير.  
- ترك **التحليل الثابت** والـ **Warnings** تتراكم.  
- اختبارات طرف-لطرف كثيرة وبطيئة بدل التركيز على **وحدات/تكامل** سريعة.  
- عدم قياس **تسرّب العيوب** للإنتاج أو زمن العلاج.

---

## جدول مقارنة مختصر

| المفهوم | الغرض الرئيسي | ملاحظات مهمة |
|---|---|---|
| **QA** | **منع العيوب وتحسين العملية** | معايير، مراجعات، استراتيجية اختبار، بوابات جودة |
| QC | كشف العيوب في المنتج الناتج | فحص/تفتيش/اختبار الناتج نفسه |
| Testing | تنفيذ فحوص للعثور على عيوب | جزء من QC؛ وحدات/تكامل/قبول/أداء/أمن |
| [SDLC](sdlc.md) | إطار مراحل التطوير | QA يرافق كل المراحل |
| SRE/Monitoring | جودة ما بعد النشر | SLIs/SLOs، تنبيهات، MTTR |

---

## ملخص الفكرة  
**QA** = مظلّة **وقائية** للجودة: معايير + اختبارات + أتمتة + قياس.  
ادمجها في **SDLC** وCI/CD ببوابات واضحة، وحافظ على **توازن** الهرم الاختباري—  
ستقلّ العيوب، وتزداد الثقة، وتتسارع الإصدارات بثبات.
